<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2021-11-30" />

<title>Group 2</title>

<script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Environmental Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Syllabus
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data science
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 1</li>
    <li>
      <a href="Rintro.html">The R and RStudio environments</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Climate science
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 1</li>
    <li>
      <a href="AQintro.html">Air Quality Lab Introduction</a>
    </li>
    <li class="dropdown-header">Week 2</li>
    <li>
      <a href="AQexp1.html">Air Quality: Test transects</a>
    </li>
    <li class="dropdown-header">Week 3</li>
    <li>
      <a href="AQexp2.html">Air Quality: Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Soil science
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="soil.html">Analyzing data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Environmental communications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="EnvComm1.html">Visualization</a>
    </li>
    <li>
      <a href="EnvComm2.html">Analysis</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Groups</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Group1.html">Group1</a>
        </li>
        <li>
          <a href="Group2.html">Group2</a>
        </li>
        <li>
          <a href="Group3.html">Group3</a>
        </li>
        <li>
          <a href="Group4.html">Group4</a>
        </li>
        <li>
          <a href="Group5.html">Group5</a>
        </li>
        <li>
          <a href="Group6.html">Group6</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Group 2</h1>
<h4 class="author"></h4>
<h4 class="date">2021-11-30</h4>

</div>


<div id="overview" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Overview</h1>
<p>This document contains code for <strong>Group 2</strong>. It is your task to modify the code in places where I have left <code>...</code> as a placeholder for a variable name. Please feel free to consult with myself and Quyen for guidance.</p>
</div>
<div id="getting-started" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Getting started</h1>
<div id="loading-in-packages" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Loading in packages</h2>
<pre><code>## Libraries for interacting with data
library(readr) # reads in spreadsheet data
library(dplyr) # lets you wrangle data more effectively
library(tidyr) # lets us interact with data with additional functions

## Libraries for plotting
library(ggplot2) # plotting library
library(waffle)  # square pie chart (waffle chart) library

## Libraries for spatial data
library(sf)       # a nicer way to deal with spatial data
library(spData)   # spatial datasets</code></pre>
</div>
<div id="importing-the-class-dataset" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Importing the class dataset</h2>
<p>Next, we’re going to import the class dataset.</p>
<pre><code>CSPdf &lt;- read_tsv(&quot;https://raw.githubusercontent.com/EA30POM/Fall2021/main/data/OTEC_CSP.tsv&quot;) # use the function read_tsv from readr to pull in a spreadsheet from this URL.
    # Then store the output in an object called &quot;CSPdf&quot;
    # CSPdf stands for Conservation Science Partners data frame</code></pre>
<p>We can always pull up a viewer of our data by using these commands:</p>
<pre><code>## Version 1:
CSPdf %&gt;% # take CSPdf and feed it into the next command
    head( ) %&gt;% # look at the first 6 rows
      View( ) # open the spreadsheet viewer
      # akin to x --&gt; f(x) --&gt; g(x)
      
## Alternatively, version 2:
View( head( CSPdf ) ) # akin to g( f( x ) )</code></pre>
</div>
</div>
<div id="addressing-the-first-question" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Addressing the first question</h1>
<p><em>What is the relationship between the topic of climate change and portrayals of (endangered) species?</em></p>
<div id="recoding-the-data" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Recoding the data</h2>
<p>The first thing we need to do is to recode the data so we know which articles are about:</p>
<ul>
<li><code>Climate Change</code> (or some other topic)</li>
</ul>
<p>If you’d like, you can modify the first commands below to also recategorize the articles based on whether or not the species is an Endangered species. Alternatively, because there are so few articles where the topic is climate change (<span class="math inline">\(n=8\)</span> out of a total <span class="math inline">\(n=971\)</span>), you could reformulate the question to be on “How do portrayals vary by endangered vs. non-endangered species”?</p>
<pre><code>### 2.1: Recategorize data
group2DF &lt;- CSPdf %&gt;%
  mutate(TopicCat = case_when(Topic==&quot;Climate Change&quot;~&quot;Climate Change&quot;,
                              Topic!=&quot;Climate Change&quot;~&quot;Other&quot;)) 
# create a new column called TopicCat that records if the article is about Climate Change or not (Other)

### 2.2: Create a cross-tabulation of TopicCat and Portrayal
group2cross &lt;- group2DF %&gt;% # start from the group 2 data
  group_by(TopicCat,Portrayal) %&gt;% # bucket the data based on TopicCat and Portrayal
  summarise(Count=...) # get the counts for each combination of TopicCat and Portrayal
`   # How would you correct the ... in the code above? 
    # Hint: n() may be helpful - it counts the instances for each combination of variables
    # save the output in the object group2cross (short for crosstab data frame)

### 2.3: Visualizing your output
  # 2.3.1: Balloon plot
g2 &lt;- ggplot(group2cross, aes(..., ..., ...)) # initiate a plot using group2cross - what columns would you want to use?
g2 # inspect intermediate output
g2 &lt;- g2 + geom_point(aes(size = Count), colour = &quot;skyblue&quot;) # plot points for each combination of topic and portrayal - change the size of the point based on the counts
g2 # inspect intermediate output
g2 &lt;- g2 + theme_bw() + labs(x=&quot;&quot;,y=&quot;&quot;,size=&quot;Count:&quot;) # modify the plot appearance
g2 # inspect intermediate output
g2 &lt;- g2 + scale_size_continuous(range=c(1,10)) + geom_text(aes(label = Count)) # add text information and change the size of the points
g2 &lt;- g2 + theme(axis.text.x = element_text(angle = 45, hjust=1),
                 legend.position = &quot;top&quot;) # change the plot visualization
g2 # display the plot</code></pre>
</div>
</div>
<div id="addressing-the-second-question" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Addressing the second question</h1>
<p><em>How are tigers portrayed in Asia and outside of Asia?</em></p>
<div id="recoding-and-subsetting-the-data" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Recoding and subsetting the data</h2>
<p>As above, we need to recode the data to be based on whether or not the <code>Country</code> of each article is in Asia or not. We also need to focus on articles about tigers.</p>
<pre><code>### 2.4: Subset the data to filter to tigers
group2sub &lt;- CSPdf %&gt;%
  filter(...) # subset to the rows where the Taxon is &quot;tiger&quot;
  # assign the output to group2sub

### 2.5: Categorize the countries as being in Asia or not
  # 2.5.1: See what the countries are
table(group2sub$Country)
group2sub &lt;- group2sub %&gt;%
  mutate(InAsia=case_when(Country %in% c(&quot;Japan&quot;,&quot;India&quot;)~&quot;Asia&quot;,
                          TRUE~&quot;Not Asia&quot;) 
  # complete the re-labelling for the other countries
  # TRUE~&quot;Placeholder&quot; just means that any other values of Country are &quot;Not Asia&quot;
View(group2sub) # see your data</code></pre>
</div>
<div id="preparing-data-for-a-waffle-plot" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Preparing data for a waffle plot</h2>
<p>The next step is to cross-tabulate the data to prepare the data for visualization.</p>
<pre><code>### 2.6: Cross tabulate portrayals for the countries that are in or outside of Asia
group2cross2 &lt;- group2sub %&gt;%
  group_by(...,...) %&gt;% # Categorize the data based on whether or not they are InAsia and the Portrayal of species
  summarise(Count=...) # get the counts for each combination of InAsia and Portrayal
`   # How would you correct the ... in the code above? 
    # Hint: n() may be helpful - it counts the instances for each combination of variables
    # save the output in the object group2cross2 (short for crosstab data frame number 2)
View(group2cross2)</code></pre>
</div>
<div id="visualization" class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> Visualization</h2>
<p>We’re ready to plot the data now.</p>
<pre><code>### 2.7: Visualize the data
waff2 &lt;- ggplot(group2cross2, aes(fill=Portrayal, values=Count)) # initiate plot
waff2 &lt;- waff2 + geom_waffle() # add on waffle charts
waff2 # display output
waff2 &lt;- waff2 + facet_wrap(~InAsia) # create sub-plots by InAsia
waff2 # display output
waff2 &lt;- waff2 + theme_void() # change the plot visuals
waff2 # display output
waff2 &lt;- waff2 + labs(x=&quot;&quot;,y=&quot;&quot;,fill=&quot;Portrayal: &quot;) + theme(legend.position=&quot;top&quot;)
waff2 # display final plot</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
