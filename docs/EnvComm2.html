<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="" />

<meta name="date" content="2021-11-30" />

<title>Week 14</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Environmental Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Syllabus
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data science
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 1</li>
    <li>
      <a href="Rintro.html">The R and RStudio environments</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Climate science
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 1</li>
    <li>
      <a href="AQintro.html">Air Quality Lab Introduction</a>
    </li>
    <li class="dropdown-header">Week 2</li>
    <li>
      <a href="AQexp1.html">Air Quality: Test transects</a>
    </li>
    <li class="dropdown-header">Week 3</li>
    <li>
      <a href="AQexp2.html">Air Quality: Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Soil science
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="soil.html">Analyzing data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Environmental communications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="EnvComm1.html">Visualization</a>
    </li>
    <li>
      <a href="EnvComm2.html">Analysis</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Groups</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Group1.html">Group1</a>
        </li>
        <li>
          <a href="Group2.html">Group2</a>
        </li>
        <li>
          <a href="Group3.html">Group3</a>
        </li>
        <li>
          <a href="Group4.html">Group4</a>
        </li>
        <li>
          <a href="Group5.html">Group5</a>
        </li>
        <li>
          <a href="Group6.html">Group6</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Week 14</h1>
<h4 class="date">2021-11-30</h4>

</div>


<div id="overview" class="section level1">
<h1><span class="header-section-number">1</span> Overview</h1>
<p>The objective this week is to analyze the class dataset, <code>CSPdf</code>, to address your group’s questions. The table below describes each group’s questions and my recommendations for a visualization.</p>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Group
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Questions
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Visualization
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">
1
</td>
<td style="text-align: center;">
What are the patterns for the topic of Human Wildlife Interaction globally?
</td>
<td style="text-align: center;">
Map
</td>
<td style="text-align: center;">
X2
</td>
</tr>
<tr>
<td style="text-align: center;">
1
</td>
<td style="text-align: center;">
Are there differences in the distribution of humans or animals being portrayed as victims in the topic of HWI?
</td>
<td style="text-align: center;">
Waffle
</td>
<td style="text-align: center;">
X2
</td>
</tr>
<tr>
<td style="text-align: center;">
2
</td>
<td style="text-align: center;">
What is the relationship between the topic of climate change and portrayals of endangered species?
</td>
<td style="text-align: center;">
Balloon/Waffle
</td>
<td style="text-align: center;">
X2
</td>
</tr>
<tr>
<td style="text-align: center;">
2
</td>
<td style="text-align: center;">
How are tigers portrayed in Asia and outside of Asia?
</td>
<td style="text-align: center;">
Waffle
</td>
<td style="text-align: center;">
X2
</td>
</tr>
<tr>
<td style="text-align: center;">
3
</td>
<td style="text-align: center;">
What are the difference in sentiments towards elephants in countries where they are native vs. non-native?
</td>
<td style="text-align: center;">
Boxplot
</td>
<td style="text-align: center;">
Difference in means
</td>
</tr>
<tr>
<td style="text-align: center;">
3
</td>
<td style="text-align: center;">
If we subset by HWI (Human Wildlife Interaction), what is the distribution of positive vs negative sentiments towards elephants?
</td>
<td style="text-align: center;">
Map/Boxplot
</td>
<td style="text-align: center;">
Difference in means
</td>
</tr>
<tr>
<td style="text-align: center;">
4
</td>
<td style="text-align: center;">
Is there a difference between shark attacks and portrayals of sharks as threats globally?
</td>
<td style="text-align: center;">
Scatterplot
</td>
<td style="text-align: center;">
X2
</td>
</tr>
<tr>
<td style="text-align: center;">
4
</td>
<td style="text-align: center;">
What is the relationship between portrayals and topics for sharks?
</td>
<td style="text-align: center;">
Balloon
</td>
<td style="text-align: center;">
X2
</td>
</tr>
<tr>
<td style="text-align: center;">
5
</td>
<td style="text-align: center;">
How does sentiment vary between sharks and pangolins?
</td>
<td style="text-align: center;">
Boxplot
</td>
<td style="text-align: center;">
Difference in means
</td>
</tr>
<tr>
<td style="text-align: center;">
5
</td>
<td style="text-align: center;">
How do sentiments towards sharks vary between countries?
</td>
<td style="text-align: center;">
Boxplot
</td>
<td style="text-align: center;">
ANOVA
</td>
</tr>
<tr>
<td style="text-align: center;">
6
</td>
<td style="text-align: center;">
Are carnivorous animals less likely to be portrayed as vulnerable or victimized than herbivorous animals?
</td>
<td style="text-align: center;">
Waffle
</td>
<td style="text-align: center;">
X2
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: center;">
6
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
Is ecotourism a more common portrayal in developing countries than in developed ones?
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
Waffle
</td>
<td style="border-bottom: 2px solid grey; text-align: center;">
X2
</td>
</tr>
</tbody>
</table>
<p>It is <strong>not necessary</strong> to perform a statistical analysis of the data to answer your question. However, for each question, I have included my own recommendation about an appropriate type of analysis. I include an example of each type of analysis below.</p>
<p>By clicking through the menu for <code>Groups</code>, you will be able to see scaffolded code for your group’s question.</p>
</div>
<div id="example-code-for-analyses" class="section level1">
<h1><span class="header-section-number">2</span> Example code for analyses</h1>
<p>In each group’s site, I provide code to subset the class data and perform a visualization to help you answer your question. However, if you would like to be able to make a claim around the <em>statistical significance</em> of your observations, you would then need some way of testing the data. That is, you need some way to quantify the <em>probability</em> that your data could have arisen by random chance.</p>
<p>First, let’s get started by pulling in the class dataset.</p>
<pre class="r"><code>## Libraries for interacting with data
library(readr) # reads in spreadsheet data
library(dplyr) # lets you wrangle data more effectively
library(tidyr) # lets us interact with data with additional functions
  # Additional package to pull in
library(mosaic)# package for permutation based tests

CSPdf &lt;- read_tsv(&quot;https://raw.githubusercontent.com/EA30POM/Fall2021/main/data/OTEC_CSP.tsv&quot;) # use the function read_tsv from readr to pull in a spreadsheet from this URL.
    # Then store the output in an object called &quot;CSPdf&quot;
    # CSPdf stands for Conservation Science Partners data frame</code></pre>
<div id="chi2-test" class="section level2">
<h2><span class="header-section-number">2.1</span> <span class="math inline">\(\chi^2\)</span> test</h2>
<p>The first type of test that I’ll cover is a <span class="math inline">\(\chi^2\)</span> test (a.k.a. a Chi-squared test). <a href="https://www.jmp.com/en_ca/statistics-knowledge-portal/chi-square-test/chi-square-test-of-independence.html">This resource</a> provides a great explanation of <span class="math inline">\(\chi^2\)</span> tests. <a href="http://www.biostathandbook.com/chiind.html">This resource</a> also provides another explanation.</p>
<p>A <span class="math inline">\(\chi^2\)</span> test is most appropriate when you have <em>counts</em> across two <em>categorical</em> variables. For instance, let’s say that I’m interested in seeing if there’s any relationship between <code>Country</code> and <code>Portrayal</code> of species in the class dataset, <code>CSPdf</code>. I would then test the null hypothesis (<span class="math inline">\(H_0\)</span>) that <code>Country</code> and <code>Portrayal</code> are unrelated. I’d expect to see that the proportional counts of portrayals across countries should be quite consistent under the null hypothesis!</p>
<p>As we saw in the <a href="https://ea30pom.github.io/Fall2021/soil.html">soil science lab</a>, one way that we can deal with wonky data is to shuffle (or re-sample) our data assuming that the null hypothesis is true. In this case, that would mean that we should be able to shuffle around <code>Country</code> with no regard for <code>Portrayal</code>.</p>
<p>Then we can compare our observed <span class="math inline">\(\chi^2\)</span> value against simulated values from shuffling our data, and see if our value is really large. If it is much larger than most of the simulated values, then that’s an indication that the data are inconsistent with the null hypothesis. Thus, we would reject the null.</p>
<p>First, let’s tally up the counts of <code>Portrayal</code> and <code>Country</code></p>
<pre class="r"><code>  ### Use tally to count up every combo of Portrayal and Country
  ### in the object CSPdf
Results_table &lt;- tally(~ Portrayal + Country, data= CSPdf )
Results_table # See the observed counts</code></pre>
<pre><code>##                Country
## Portrayal       Armenia Australia Bangladesh Bulgaria Cambodia Cameroon Canada
##   Aesthetic           0         0          0        0        0        0      3
##   Controversial       0         0          0        0        0        0      1
##   Dangerous           0         8          0        0        0        1      4
##   Exciting            0         0          0        0        0        0      3
##   Important           0         1          1        0        1        0      2
##   Interesting         1         2          1        1        1        0      6
##   Neutral             0         1          0        0        0        0      5
##   Nuisance            0         1          0        0        0        0      1
##   Resilient           0         2          0        1        0        0      3
##   Valuable            0         2          1        0        0        0      2
##   Victim              0         3          0        0        0        0      9
##   Vulnerable          1         3          2        1        2        1      9
##                Country
## Portrayal       China Germany India Indonesia Ireland Israel Japan Kenya
##   Aesthetic         0       0     1         0       0      0     0     0
##   Controversial     1       0     4         0       1      0     0     0
##   Dangerous         0       0     4         0       1      2     0     0
##   Exciting          0       0     7         0       0      0     3     0
##   Important         1       0     6         0       0      0     0     1
##   Interesting       0       0     8         1       1      1     0     1
##   Neutral           1       0     9         1       0      1     0     0
##   Nuisance          0       0     5         0       0      1     0     0
##   Resilient         1       0     5         0       0      0     0     0
##   Valuable          4       0     6         0       0      0     0     0
##   Victim            3       2    23         1       0      2     1     1
##   Vulnerable       12       0    29        13       0      1     0     1
##                Country
## Portrayal       Malaysia Mexico New Zealand Nigeria Philippines Qatar Russia
##   Aesthetic            0      0           0       0           0     0      0
##   Controversial        0      0           0       0           0     0      0
##   Dangerous            0      0           2       0           0     0      0
##   Exciting             0      0           1       0           0     0      0
##   Important            0      1           1       2           0     0      0
##   Interesting          0      0           1       0           5     1      2
##   Neutral              0      0           1       0           0     0      0
##   Nuisance             0      0           0       0           0     0      0
##   Resilient            0      0           0       1           0     0      0
##   Valuable             1      0           1       1           2     0      0
##   Victim               2      0           0       3           4     0      0
##   Vulnerable           3      0           0       6           3     0      2
##                Country
## Portrayal       Saudi Arabia Singapore South Africa Switzerland Tanzania
##   Aesthetic                0         0            0           0        0
##   Controversial            0         0            3           0        0
##   Dangerous                0         0            3           1        0
##   Exciting                 1         1            2           0        0
##   Important                0         1            2           0        0
##   Interesting              1         1            2           0        1
##   Neutral                  2         0            1           0        0
##   Nuisance                 0         0            0           0        0
##   Resilient                0         0            0           0        0
##   Valuable                 0         1            3           0        0
##   Victim                   0         0            9           0        0
##   Vulnerable               0         0           11           0        0
##                Country
## Portrayal       Thailand Turkey United Arab Emirates United Kingdom
##   Aesthetic            0      0                    0              2
##   Controversial        0      0                    0              1
##   Dangerous            0      0                    0             13
##   Exciting             2      0                    1              9
##   Important            0      0                    0              4
##   Interesting          0      0                    0             12
##   Neutral              0      0                    0              9
##   Nuisance             0      0                    0              1
##   Resilient            0      0                    0              3
##   Valuable             1      1                    0              1
##   Victim               0      1                    0             14
##   Vulnerable           0      0                    0             52
##                Country
## Portrayal       United States Vietnam Zambia Zimbabwe
##   Aesthetic                 3       0      0        0
##   Controversial            26       0      0        0
##   Dangerous                65       0      2        0
##   Exciting                 36       0      0        0
##   Important                29       1      0        0
##   Interesting              72       2      0        0
##   Neutral                  52       1      0        0
##   Nuisance                 30       0      0        0
##   Resilient                18       0      0        0
##   Valuable                 17       0      0        0
##   Victim                   45       4      1        1
##   Vulnerable               84       7      0        2</code></pre>
<p>Second, let’s calculate <span class="math inline">\(\chi^2\)</span> for our actual data.</p>
<pre class="r"><code>  ### Calculate the Chi-squared value for our data
obs_chi &lt;- chisq(Results_table)
obs_chi # see the observed Chi-squared value</code></pre>
<pre><code>## X.squared 
##  477.5231</code></pre>
<p>Third, let’s shuffle the data 1000 times and calculate a <span class="math inline">\(\chi^2\)</span> value for every time the data the shuffled.</p>
<pre class="r"><code>  ### Shuffle/sample the data 1000 times
  ### And calculate the Chi-squared value each time
SimulateChiSq &lt;- do(1000) * chisq( tally( ~ Portrayal + shuffle(Country), data= CSPdf))</code></pre>
<p>Finally, let’s see what proportion (<span class="math inline">\(p\)</span>-value) of the simulated <span class="math inline">\(\chi^2\)</span> values are bigger than our observed value.</p>
<pre class="r"><code>  ### Calculate the proportion of values larger than our Chi-squared value
sim_p_val &lt;- length(which(SimulateChiSq$X.squared &gt; obs_chi))/nrow(SimulateChiSq)
sim_p_val # Is this &lt; 0.05?</code></pre>
<pre><code>## [1] 0.025</code></pre>
</div>
<div id="difference-in-means---two-samples" class="section level2">
<h2><span class="header-section-number">2.2</span> Difference in means - two samples</h2>
<p>We’ve seen this type of analysis before (see the <a href="https://ea30pom.github.io/Fall2021/soil.html">soil science lab</a>, section 3.1) so I won’t go into as much detail.</p>
<p>Let’s take an example from the class dataset. Let’s say that I want to know if <code>Sentiment</code> varies across wolves vs. animals that aren’t wolves. That means that we’re comparing <code>Sentiment</code> across just two types of animals (<code>Taxon=="wolf"</code> or not).</p>
<p>We can test the null hypothesis (<span class="math inline">\(H_0\)</span>) that there is no difference in the mean sentiment for wolves vs. other animals. But as is the case for some of the groups, that’s going to mean that we’ll have to re-code the data. We need to say, based on <code>Taxon</code> if the article is about <code>wolf</code> or <code>not wolf</code>.</p>
<pre class="r"><code>recode_CSP &lt;- CSPdf %&gt;%
  mutate(WolfOrNot = case_when(Taxon==&quot;wolf&quot;~&quot;Wolf&quot;,
                               TRUE ~ &quot;Not Wolf&quot;))
  # create a new column called WolfOrNot
  # That codes the data based on the value in Taxon

# View(recode_CSP)</code></pre>
<p>Second, we’ll calculate the observed difference in mean sentiment between <code>Wolf</code> and <code>Not Wolf</code> articles.</p>
<pre class="r"><code>obs_diff &lt;- diff(mean( Sentiment ~ WolfOrNot, data=recode_CSP)) # calculate the difference between the means and store in a variable called &quot;obs_diff&quot;
obs_diff # display the value of obs_diff</code></pre>
<pre><code>##        Wolf 
## -0.01338776</code></pre>
<p>Third, we’ll now shuffle the data 1000 times and calculate the difference in mean sentiment across Wolf or Not Wolf each time.</p>
<pre class="r"><code># Shuffle the data and calculate the simulated differences in mean Sentiment
randomizing_diffs &lt;- do(1000) * diff( mean( Sentiment ~ shuffle(WolfOrNot), data = recode_CSP) ) # calculate the mean in SoilDensity when we&#39;re shuffling the plant community around 1000 times
# Clean up our shuffled data
names(randomizing_diffs)[1] &lt;- &quot;DiffMeans&quot; # change the name of the variable
# View first few rows of data
head(randomizing_diffs)</code></pre>
<pre><code>##      DiffMeans
## 1 -0.067686811
## 2 -0.043996547
## 3  0.084564769
## 4  0.033222414
## 5 -0.005977672
## 6 -0.047298070</code></pre>
<pre class="r"><code># View the mean of the simulated differences
mean(randomizing_diffs$DiffMeans) # is this larger or smaller than our observed difference</code></pre>
<pre><code>## [1] -0.0006127999</code></pre>
<p>Based on what we saw above, it looks like our <code>obs_diff</code> may be smaller than most of the simulated differences in means. That means that more extreme data would be <em>smaller</em> than our observed difference.</p>
<p>Fourth, we’ll calculate the probability that the simulated differences in mean sentiment were more extreme than our observed value.</p>
<pre class="r"><code># What proportion of simulated values were &quot;more extreme&quot; than our value?
prop( ~ DiffMeans &lt; obs_diff, data = randomizing_diffs)</code></pre>
<pre><code>## prop_TRUE 
##     0.399</code></pre>
</div>
<div id="difference-in-means---more-than-two-samples" class="section level2">
<h2><span class="header-section-number">2.3</span> Difference in means - more than two samples</h2>
<p>When we want to test whether or not three or more groups have the same mean value for some variable, we tend to use a one-way ANOVA test. While I briefly described ANOVA tests back in <a href="https://ea30pom.github.io/Fall2021/AQexp2.html">Week 3</a>, we didn’t get to cover that type of analysis in any depth. If you’d like some explanation about this type of test, please refer to this resource by <a href="https://www.jmp.com/en_ca/statistics-knowledge-portal/one-way-anova.html#404f1893-ae56-43ed-b84c-f6c99f313eca">JMP</a> or <a href="http://www.biostathandbook.com/onewayanova.html">the Handbook of Biological Statistics</a>.</p>
<p>Let’s say I’m interested in comparing mean <code>Sentiment</code> across all of the countries in our sample. I can perform an ANOVA test on the data. Great. But how do I know if 1) there are differences in mean sentiment across countries, and 2) these differences are meaningful?</p>
<p>I can shuffle the data! If I assume the null hypothesis (<span class="math inline">\(H_0\)</span>) that mean sentiment is <em>the same</em> across all of the countries, then that means that I can shuffle <code>Country</code> independent of <code>Sentiment</code>.</p>
<p>Let’s start by calculating a test statistic using an ANOVA test on our dataset.</p>
<pre class="r"><code>obs_aov &lt;- anova( lm( Sentiment ~ Country, data= CSPdf))$`F value`[1] # calculate a test statistic from our data
obs_aov # display the value of the test statistic</code></pre>
<pre><code>## [1] 3.061811</code></pre>
<p>Second, we’ll shuffle the data 1000 times, assuming that <code>Country</code> doesn’t matter for <code>Sentiment</code>.</p>
<pre class="r"><code>sim_aov &lt;- do(1000) * anova(lm( Sentiment ~ shuffle(Country), data=CSPdf))$`F value`[1]
head(sim_aov) # display the first few rows of simulated test statistics</code></pre>
<pre><code>##      result
## 1 0.5930035
## 2 0.8801567
## 3 1.1233541
## 4 1.1706447
## 5 0.8775084
## 6 0.6880138</code></pre>
<p>Third, we’ll calculate a <span class="math inline">\(p\)</span>-value based on the proportion of simulated test statistics that are larger than our observed test statistic.</p>
<pre class="r"><code>prop( ~ result &gt; obs_aov, data=sim_aov)</code></pre>
<pre><code>## prop_TRUE 
##         0</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
